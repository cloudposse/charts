export REPO_URL := $(REPO_URL)/$(shell basename $(CURDIR))

.PHONY : info
info:
	@make -C packages/ $@

.PHONY : package
package:
	@find library/ -maxdepth 1 -mindepth 1 -type d '!' -name packages  | xargs -n 1 -I '{}' helm dependency update {}
	@find library/ -maxdepth 1 -mindepth 1 -type d '!' -name packages  | xargs -n 1 -I '{}' helm package {}
	@find . -maxdepth 1 -mindepth 1 -type f -name '*.tgz' | xargs -I '{}' mv {} packages

.PHONY : index
index:
	@make -C packages/ $@

.PHONY : clean
clean:
	@rm -f *.tgz
  
.PHONY : real-clean
real-clean: clean
	@make -C packages/ $@
